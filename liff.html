<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>LIFF userId取得サンプル</title>
  <!-- ✅ 正しい SDK の読み込み -->
  https://static.line-scdn.net/liff/edge/2/sdk.js</script>
</head>
<body>
  <h1>LINE userId取得</h1>
  <div id="userid">読み込み中...</div>

  <script>
    (async () => {
      const liffId = "2008150322-vGVmLzYg"; // ← 本物のLIFF IDに変更
      const out = (msg) => { document.getElementById('userid').innerText = msg; }

      try {
        out("LIFF初期化中...");
        await liff.init({ liffId });
        await liff.ready; // 読み込み完了を待つ（任意）

        if (!liff.isLoggedIn()) {
          out("ログインしていません。ログインへリダイレクトします…");
          // 現在のURLに戻るようにしておくのがコツ
          liff.login({ redirectUri: location.href });
          return; // ここで処理終了（リダイレクトされます）
        }

        out("ログイン済み。プロフィール取得中...");
        const profile = await liff.getProfile();
        out(`userId: ${profile.userId}\nname: ${profile.displayName}`);
      } catch (err) {
        console.error(err);
        out("エラー: " + (err?.message || JSON.stringify(err)));
      }
    })();
  </script>
</body>
</html>


